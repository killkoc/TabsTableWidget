function ttmCreateGSTWidget(e,t,r){if(e.hasAttribute("ttmWidgetInit"))return;e.setAttribute("ttmWidgetInit","");let l=`${r}-${t}`;e.id=l;let a=e.getAttribute("data-ttmGSID");if(!a){c(e);return}let n=`https://docs.google.com/spreadsheets/d/e/${a}/pub?output=csv`;async function i(e){let t=await fetch(e);if(!t.ok)throw Error(`HTTP error! status: ${t.status}`);return await t.text()}function d(e,t,r){let l=e.querySelectorAll("ul li"),a=e.querySelectorAll(`.widget-container .tab-content, #${t} .widget-container .table-content`);Array.from(l).forEach((e,t)=>{e.classList.remove("bg-blue-500"),a[t].style.display="none"}),l[r].classList.add("bg-blue-500"),a[r].style.display="block"}function s(e,t=!0){var r;let l=(r=e[0],Object.keys(r).map(e=>{let t="text-center",r=e,l="text-white",a="";r.includes("{C}")?(t="text-center",r=r.replace("{C}","")):r.includes("{L}")?(t="text-left",r=r.replace("{L}","")):r.includes("{R}")&&(t="text-right",r=r.replace("{R}","")),r.includes("{r}")?(l="text-red-500",r=r.replace("{r}","")):r.includes("{g}")?(l="text-green-500",r=r.replace("{g}","")):r.includes("{b}")&&(l="text-blue-500",r=r.replace("{b}",""));let n=r.match(/{f(\d+)}/);return n&&(a=n[1],r=r.replace(n[0],"")),r=r.split("_")[0],{header:r,alignment:t,originalHeader:e,textColor:l,fontSize:a}})),a=l.length,n=`${Math.floor(100/a)}%`,i=l.every(({header:e})=>!e.trim()),d=l.map(({header:e,alignment:t,textColor:r,fontSize:l})=>{let a=e;return l&&(a=`<span style="font-size:${l}px">${e}</span>`),`<th scope="col" style="width: ${n}" class="px-5 py-5 border-b-2 border-gray-200 bg-blue-500 ${t} font-semibold ${r} uppercase align-middle">${a}</th>`}).join(""),s=e.map((e,t)=>{var r,a,i,d;let s,c;return r=e,a=l,i=n,d=t,s=d%2==0?"<tr>":'<tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600">',c=0,a.forEach(({originalHeader:e,alignment:t,textColor:l,fontSize:n})=>{if(c>0){c--;return}let d=r[e],o=t,u="text-white"===l?"text-black":l,g=1;if(d&&d.includes("{C}")?(o="text-center",d=d.replace("{C}","")):d&&d.includes("{L}")?(o="text-left",d=d.replace("{L}","")):d&&d.includes("{R}")&&(o="text-right",d=d.replace("{R}","")),d&&d.includes("{r}")?(u="text-red-500",d=d.replace("{r}","")):d&&d.includes("{g}")?(u="text-green-500",d=d.replace("{g}","")):d&&d.includes("{b}")&&(u="text-blue-500",d=d.replace("{b}","")),d&&d.includes("{W}")){d=d.replace("{W}","");let p=a.findIndex(({originalHeader:t})=>t===e)+1;for(;p<a.length&&(!r[a[p].originalHeader]||""===r[a[p].originalHeader]);)g++,c++,p++}let b=d.match(/{f(\d+)}/);b&&(n=b[1],d=d.replace(b[0],"")),s+=function e(t,r,l,a,n,i){if(1===r&&""===l)return`<td style="width: ${t}" class="px-3 py-5 border-b border-gray-200 bg-white ${a} ${n} align-middle"></td>`;if(""!==l){if(!l.includes("{B}"))return`<td style="width: ${t}; font-size: ${i}px" colspan="${r}" class="px-3 py-5 border-b border-gray-200 bg-white ${a} ${n} align-middle">${l}</td>`;{let[d,s]=l.replace("{B}","").split(">");return s.startsWith("http://")||s.startsWith("https://")||(s=`https://${s}`),`<td style="width: ${t}; font-size: ${i}px" colspan="${r}" class="px-3 py-5 border-b border-gray-200 bg-white ${a} ${n} align-middle"><button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded" onclick="window.open('${s}', '_blank')">${d}</button></td>`}}}(i,g,d,u,o,n)}),s+"</tr>"}).join(""),c=`<div class="relative overflow-x-auto shadow-sm ${t?"sm:rounded-lg":""}"><table class="ttmTable-content w-full text-xs text-left text-gray-500 dark:text-gray-400">${i?`<tr><td colspan="${a}" style="border-bottom: 1px solid #ccc;"></td></tr>`:`<thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"><tr>${d}</tr></thead>`}<tbody>${s}</tbody></table></div>`;return c.replace(/colspan="1"\\s*/g,"")}function c(e){let t=e.querySelector(".widget-container");t.innerHTML=`<div style="width: 100%; height: 200px; background-color: lightgray; display: flex; justify-content: center; align-items: center;"><p>Google Sheet not found! Add a Data Attribute named data-ttmGSID whose value is the published ID of the Google Sheet you want to access</p></div>`,console.error("Google Sheet not found! Add a Data Attribute named data-ttmGSID whose value is the published ID of the Google Sheet you want to access")}i(n).then(t=>{let a=function e(t){t=t.replace(/\r\n/g,"\n");let[r,...l]=t.split("\n"),a=r.split(","),n=a.map((e,t)=>`${e}_${t}`);return l.map(e=>{let t=e.split(",");return Object.fromEntries(n.map((e,r)=>[e,t[r]||""]))})}(t);"ttmTabsWidget"===r?function e(t,r,l){0===t.children.length&&(t.innerHTML='<div class="flex justify-center"><div class="w-full"><div class="bg-transparent shadow-sm rounded-sm my-6"><ul class="flex justify-around"></ul><div class="w-full widget-container"></div></div></div></div>');let a=t.querySelector("ul"),n=t.querySelector(".widget-container"),i=document.createDocumentFragment(),c=document.createDocumentFragment(),o=new Set,u=0,g=Object.keys(l[0])[0];return l.forEach(e=>{let l=e[g];!o.has(l)&&(o.add(l),i.appendChild(function e(t,r,l,a){let n=document.createElement("li");return n.className="flex-auto ml-0 last:mr-0 text-center bg-gray-400 text-white rounded-t-xl ttmTab-element",n.innerHTML=`<div class="text-xs font-bold uppercase px-5 py-3 block leading-normal">${l}</div>`,n.addEventListener("click",()=>d(t,r,a)),n}(t,r,l,u)),u++)}),Array.from(o).forEach((e,t)=>{c.appendChild(function e(t,r,l,a){let n=l.filter(e=>e[a]===t).map(e=>{let{[a]:t,...r}=e;return r}),i=s(n,!1),d=document.createElement("div");return d.innerHTML=i,d.style.display=0===r?"block":"none",d.classList.add("tab-content"),d}(e,t,l,g))}),a.appendChild(i),n.appendChild(c),a.firstElementChild.click(),a.addEventListener("click",e=>{if(e.target&&e.target.matches(".ttmTab-element")){let l=Array.from(a.children).indexOf(e.target);d(t,r,l)}}),o}(e,l,a):function e(t,r,l){0===t.children.length&&(t.innerHTML='<div class="flex justify-center"><div class="w-full"><div class="bg-transparent shadow-sm rounded-sm my-6"><div class="w-full widget-container"></div></div></div></div>');let a=t.querySelector(".widget-container"),n=s(l,!0);a.innerHTML=n,a.classList.add("table-content")}(e,l,a)}).catch(t=>{console.error("Error fetching Google Sheet data:",t),c(e)})}document.addEventListener("DOMContentLoaded",function(){Array.from(document.getElementsByClassName("ttmTabsWidget")).forEach((e,t)=>{ttmCreateGSTWidget(e,t,"ttmTabsWidget")}),Array.from(document.getElementsByClassName("ttmTableWidget")).forEach((e,t)=>{ttmCreateGSTWidget(e,t,"ttmTableWidget")})},!1);
