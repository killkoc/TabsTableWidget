function ttmCreateGSTWidget(e,t,r){if(e.hasAttribute("ttmWidgetInit"))return;e.setAttribute("ttmWidgetInit","");let l=`${r}-${t}`;e.id=l;let a=document.querySelector(`#${l} ul`),n=document.querySelector(`#${l} .widget-container`),i=e.getAttribute("data-ttmGSID");if(!i){u();return}let d=`https://docs.google.com/spreadsheets/d/e/${i}/pub?output=csv`;async function o(e){let t=await fetch(e);if(!t.ok)throw Error(`HTTP error! status: ${t.status}`);return await t.text()}function s(e){let t=document.querySelectorAll(`#${l} ul li`),r=document.querySelectorAll(`#${l} .widget-container .tab-content, #${l} .widget-container .table-content`);Array.from(t).forEach((e,t)=>{e.classList.remove("bg-blue-500"),r[t].style.display="none"}),t[e].classList.add("bg-blue-500"),r[e].style.display="block"}function c(e,t=!0){var r;let l=(r=e[0],Object.keys(r).map(e=>{let t="text-center",r=e,l="text-white",a="";r.includes("{C}")?(t="text-center",r=r.replace("{C}","")):r.includes("{L}")?(t="text-left",r=r.replace("{L}","")):r.includes("{R}")&&(t="text-right",r=r.replace("{R}","")),r.includes("{r}")?(l="text-red-500",r=r.replace("{r}","")):r.includes("{g}")?(l="text-green-500",r=r.replace("{g}","")):r.includes("{b}")&&(l="text-blue-500",r=r.replace("{b}",""));let n=r.match(/{f(\d+)}/);return n&&(a=n[1],r=r.replace(n[0],"")),r=r.split("_")[0],{header:r,alignment:t,originalHeader:e,textColor:l,fontSize:a}})),a=l.length,n=`${Math.floor(100/a)}%`,i=l.every(({header:e})=>!e.trim()),d=l.map(({header:e,alignment:t,textColor:r,fontSize:l})=>{let a=e;return l&&(a=`<span style="font-size:${l}px">${e}</span>`),`<th scope="col" style="width: ${n}" class="px-5 py-5 border-b-2 border-gray-200 bg-blue-500 ${t} font-semibold ${r} uppercase align-middle">${a}</th>`}).join(""),o=e.map((e,t)=>{var r,a,i,d;let o,s;return r=e,a=l,i=n,d=t,o=d%2==0?"<tr>":'<tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600">',s=0,a.forEach(({originalHeader:e,alignment:t,textColor:l,fontSize:n})=>{if(s>0){s--;return}let d=r[e],c=t,u="text-white"===l?"text-black":l,g=1;if(d&&d.includes("{C}")?(c="text-center",d=d.replace("{C}","")):d&&d.includes("{L}")?(c="text-left",d=d.replace("{L}","")):d&&d.includes("{R}")&&(c="text-right",d=d.replace("{R}","")),d&&d.includes("{r}")?(u="text-red-500",d=d.replace("{r}","")):d&&d.includes("{g}")?(u="text-green-500",d=d.replace("{g}","")):d&&d.includes("{b}")&&(u="text-blue-500",d=d.replace("{b}","")),d&&d.includes("{W}")){d=d.replace("{W}","");let p=a.findIndex(({originalHeader:t})=>t===e)+1;for(;p<a.length&&(!r[a[p].originalHeader]||""===r[a[p].originalHeader]);)g++,s++,p++}let b=d.match(/{f(\d+)}/);b&&(n=b[1],d=d.replace(b[0],"")),o+=function e(t,r,l,a,n,i){if(1===r&&""===l)return`<td style="width: ${t}" class="px-3 py-5 border-b border-gray-200 bg-white ${a} ${n} align-middle"></td>`;if(""!==l){if(!l.includes("{B}"))return`<td style="width: ${t}; font-size: ${i}px" colspan="${r}" class="px-3 py-5 border-b border-gray-200 bg-white ${a} ${n} align-middle">${l}</td>`;{let[d,o]=l.replace("{B}","").split(">");return o.startsWith("http://")||o.startsWith("https://")||(o=`https://${o}`),`<td style="width: ${t}; font-size: ${i}px" colspan="${r}" class="px-3 py-5 border-b border-gray-200 bg-white ${a} ${n} align-middle"><button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded" onclick="window.open('${o}', '_blank')">${d}</button></td>`}}}(i,g,d,u,c,n)}),o+"</tr>"}).join(""),s=`<div class="relative overflow-x-auto shadow-sm ${t?"sm:rounded-lg":""}"><table class="ttmTable-content w-full text-xs text-left text-gray-500 dark:text-gray-400">${i?`<tr><td colspan="${a}" style="border-bottom: 1px solid #ccc;"></td></tr>`:`<thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"><tr>${d}</tr></thead>`}<tbody>${o}</tbody></table></div>`;return s.replace(/colspan="1"\\s*/g,"")}function u(){let e=document.querySelector(`#${l} .widget-container`);e.innerHTML=`<div style="width: 100%; height: 200px; background-color: lightgray; display: flex; justify-content: center; align-items: center;"><p>Google Sheet not found! Add a Data Attribute named data-ttmGSID whose value is the published ID of the Google Sheet you want to access</p></div>`,console.error("Google Sheet not found! Add a Data Attribute named data-ttmGSID whose value is the published ID of the Google Sheet you want to access")}o(d).then(e=>{let t=function e(t){t=t.replace(/\r\n/g,"\n");let[r,...l]=t.split("\n"),a=r.split(","),n=a.map((e,t)=>`${e}_${t}`);return l.map(e=>{let t=e.split(",");return Object.fromEntries(n.map((e,r)=>[e,t[r]||""]))})}(e);"ttmTabsWidget"===r?function e(t){let r=document.createDocumentFragment(),l=document.createDocumentFragment(),i=new Set,d=0,o=Object.keys(t[0])[0];return t.forEach(e=>{let t=e[o];!i.has(t)&&(i.add(t),r.appendChild(function e(t,r){let l=document.createElement("li");return l.className="flex-auto ml-0 last:mr-0 text-center bg-gray-400 text-white rounded-t-xl ttmTab-element",l.innerHTML=`<div class="text-xs font-bold uppercase px-5 py-3 block leading-normal">${t}</div>`,l.addEventListener("click",()=>s(r)),l}(t,d)),d++)}),Array.from(i).forEach((e,r)=>{l.appendChild(function e(t,r,l,a){let n=l.filter(e=>e[a]===t).map(e=>{let{[a]:t,...r}=e;return r}),i=c(n,!1),d=document.createElement("div");return d.innerHTML=i,d.style.display=0===r?"block":"none",d.classList.add("tab-content"),d}(e,r,t,o))}),a.appendChild(r),n.appendChild(l),a.firstElementChild.click(),a.addEventListener("click",e=>{if(e.target&&e.target.matches(".ttmTab-element")){let t=Array.from(a.children).indexOf(e.target);s(e.target,t)}}),i}(t):function e(t){let r=document.querySelector(`#${l} .widget-container`),a=c(t,!0);r.innerHTML=a,r.classList.add("table-content")}(t)}).catch(e=>{console.error("Error fetching Google Sheet data:",e),u()})}document.addEventListener("DOMContentLoaded",function(){Array.from(document.getElementsByClassName("ttmTabsWidget")).forEach((e,t)=>{ttmCreateGSTWidget(e,t,"ttmTabsWidget")}),Array.from(document.getElementsByClassName("ttmTableWidget")).forEach((e,t)=>{ttmCreateGSTWidget(e,t,"ttmTableWidget")})},!1);
